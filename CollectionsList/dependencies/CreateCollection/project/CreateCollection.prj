{"parameters":{"name":"CreateCollection.prj","exposeAs":"$root","tag":"div","text":"","custom-params":"[{\"name\":\"data\",\"value\":\"{}\",\"type\":\"String\"},{\"name\":\"new\",\"value\":null,\"type\":\"boolean\"},{\"name\":null,\"value\":null,\"type\":null},{\"name\":null,\"value\":null,\"type\":null},{\"name\":null,\"value\":null,\"type\":null},{\"name\":null,\"value\":null,\"type\":null},{\"name\":null,\"value\":null,\"type\":null},{\"name\":null,\"value\":null,\"type\":null}]","listeners":"{\"saved\":\"fired when collection is saved\",\"cancel\":\"user clicked on cancel\"}"},"children":[{"parameters":{"name":"resource"},"children":[{"parameters":{"name":"bootstrapJS","src":"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:javascript"},{"parameters":{"name":"popperJS","src":"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:javascript"},{"parameters":{"name":"bootstrapCSS","source":"https://getbootstrap.com/docs/4.0/dist/css/bootstrap.min.css","crossorigin":"anonymous","media":"all"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:stylesheet"},{"parameters":{"name":"bootstrapPatch","source":"css/bootstrap.patch.css","crossorigin":"anonymous","media":"all"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:stylesheet"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:resources"},{"parameters":{"name":"Icons","source":"/open-iconic/font/css/open-iconic-bootstrap.min.css","crossorigin":"anonymous","media":"all","minified":"true"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:open-iconic"},{"parameters":{"name":"Row","class":"row"},"children":[{"parameters":{"name":"Col","class":"col"},"children":[{"parameters":{"name":"html fragment","tag":"div","template":"#nav"},"children":[{"parameters":{"name":"save","class":"btn btn-primary","label":"Save","context":"primary","type":"button"},"children":[],"events":[{"type":"click","source":"doSubmit($scope);","name":"save"}],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:button"},{"parameters":{"name":"cancel","class":"btn","label":"Cancel","context":"none","type":"button"},"children":[],"events":[{"type":"click","source":"$scope.$root.fireListener('cancel', evt);","name":"cancel"}],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:button"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:html"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:column"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:row"},{"parameters":{"name":"Form","class":"container","exposeAs":"form","tag":"form","text":""},"children":[{"parameters":{"name":"Row","class":"row"},"children":[{"parameters":{"name":"col-left","class":"col col-md-8","WidthMedium":"8"},"children":[{"parameters":{"name":"Form","exposeAs":"textform","tag":"form","text":""},"children":[{"parameters":{"name":"card-textual","class":"card mt-3 card-textual","tag":"div","text":""},"children":[{"parameters":{"name":"body","class":"card-body","tag":"div","text":""},"children":[{"parameters":{"name":"title","class":"card-title","tag":"h4","text":"Add Collection"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:p"},{"parameters":{"name":"title","class":"form-group slds-has-error","type":"string","label":"Title","required":"true","hasError":"false"},"children":[{"parameters":{"name":"title","class":"form-control ","binding":"title","prequired":"true","placeholder":"E.g. Home Page","type":"string","plainText":"false"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:input-string"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:form-group"},{"parameters":{"name":"description","class":"form-group slds-has-error","type":"textarea","label":"Description","required":"true","hasError":"false"},"children":[{"parameters":{"name":"description","class":"form-control slds-textarea ","exposeAs":"description","binding":"description","prequired":"true","rows":"6","cols":"20","plainText":"false"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:textarea"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:form-group"},{"parameters":{"name":"id","exposeAs":"id","binding":"_id","type":"number"},"children":[],"events":[],"macros":[],"styles":{"display":"none"},"dependencies":[],"impl":"html:numeric-input"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:div"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:div"}],"events":[{"type":"submit","source":"var collection = evt.data;\r\nvar andOr = $scope.andOr.getValue();\r\n//alert(andOr);\r\nvar haserror = false;\r\nif(andOr === null){\r\n    $scope.andOr.addClass('is-invalid');\r\n    $scope.matcherror.setStyle('display', null);\r\n    haserror = true;\r\n}else{\r\n    $scope.andOr.removeClass('is-invalid');\r\n    collection.andOr = andOr;\r\n    $scope.matcherror.setStyle('display', 'none');\r\n}\r\n\r\n\r\nvar criteria = $scope.criteria.getData();\r\nif(criteria === null || criteria.length <=0){\r\n    $scope.criteria.addClass('is-invalid');\r\n    $scope.operatorerror.setStyle('display', null);\r\n    haserror = true;\r\n}else{\r\n     $scope.criteria.removeClass('is-invalid');\r\n    collection.criteria = criteria;\r\n    $scope.operatorerror.setStyle('display', 'none');\r\n}\r\n\r\nvar image = $scope.image.getValue();\r\nif(image === null  || image === ''){\r\n    $scope.image.setError('Please choose an image for the collection');\r\n    haserror = true;\r\n}else{\r\n    $scope.image.clearError();\r\n    collection.image = image;\r\n}\r\ncollection.onlineStatus = 'unpublished';\r\nif(!haserror){\r\n    //alert(JSON.stringify(collection));\r\n    $scope.collections.insertDocument(collection);\r\n}","name":"Form"}],"macros":[],"styles":{},"dependencies":[],"impl":"html:form"},{"parameters":{"name":"card-textual_1","class":"card mt-3 card-textual","tag":"div","text":""},"children":[{"parameters":{"name":"body","class":"card-body","tag":"div","text":""},"children":[{"parameters":{"name":"title","class":"card-title","tag":"h4","text":"Conditions"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:p"},{"parameters":{"name":"conditionsTitle","tag":"label","text":"Products must match:"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:p"},{"parameters":{"name":"andOr","class":"form-control","exposeAs":"andOr","options":"{\"and\":\"all conditions\",\"or\":\"any condition\"}"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:form-options"},{"parameters":{"name":"matcherror","class":"","exposeAs":"matcherror","tag":"p","text":"Please select a match type"},"children":[],"events":[],"macros":[],"styles":{"color":"#dc3545","font-weight":"400","font-size":"0.8rem","display":"none"},"dependencies":[],"impl":"html:p"},{"parameters":{"name":"Table","class":"table table-sm options-table","exposeAs":"criteria","IdField":"field","small":"true","fireRowSelectionOn":"click","rowSelectionMode":"radio","selectedRowDecoratorClass":"table-active"},"children":[{"parameters":{"name":"field","label":"Field","binding":"field","dataType":"text","renderAs":"default"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:table-column"},{"parameters":{"name":"operator","label":"Operator","binding":"operator","dataType":"text","renderAs":"default"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:table-column"},{"parameters":{"name":"value","label":"Value","binding":"value","dataType":"text","renderAs":"default"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:table-column"}],"events":[{"type":"renderCell","source":"renderCells($scope,evt);","name":"Table"}],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:table"},{"parameters":{"name":"operatorerror","class":"","exposeAs":"operatorerror","tag":"p","text":"Please add at least one criteria"},"children":[],"events":[],"macros":[],"styles":{"color":"#dc3545","font-weight":"400","font-size":"0.8rem","display":"none"},"dependencies":[],"impl":"html:p"},{"parameters":{"name":"Ruler"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:hr"},{"parameters":{"name":"btnAddOption","class":"btn btn-sm","label":"Add another option","context":"none","type":"button","dsize":"btn-sm"},"children":[],"events":[{"type":"click","source":"var data = $scope.criteria.getData();\r\ndata.push(getDefaultLine());\r\n$scope.criteria.setData(data);","name":"btnAddOption"}],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:button"},{"parameters":{"name":"btnDeleteSelected","class":"btn ml-3           btn-danger btn-sm","label":"Delete selected options","context":"danger","type":"button","dsize":"btn-sm"},"children":[],"events":[{"type":"click","source":"$scope.criteria.deleteSelected();","name":"btnDeleteSelected"}],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:button"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:div"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:div"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:column"},{"parameters":{"name":"col-right","class":"col col-md-4","WidthMedium":"4"},"children":[{"parameters":{"name":"card-availability","class":"card mt-3 card-images","exposeAs":"cardavailability","tag":"div","text":""},"children":[{"parameters":{"name":"body","class":"card-body","tag":"div","text":""},"children":[{"parameters":{"name":"title","class":"card-subtitle   mb-2 text-muted","tag":"label","text":"Availability online"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:p"},{"parameters":{"name":"Row","class":"row"},"children":[{"parameters":{"name":"Col","class":"col 2 2   ","WidthExtraSmall":"nowidth","WidthSmall":"nowidth","WidthMedium":"nowidth","WidthLarge":"nowidth","WidthExtraLarge":"nowidth"},"children":[{"parameters":{"name":"btnPublish","class":"btn   btn-success btn-sm","label":"Publish this Collection","exposeAs":"btnPublish","context":"success","type":"button","dsize":"btn-sm"},"children":[],"events":[{"type":"click","source":"var data = {\r\n    _id:$scope.id.getValue(),\r\n    onlineStatus:'published'\r\n}\r\n\r\n$scope.collections.insertDocument(data);\r\n","name":"btnPublish"}],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:button"},{"parameters":{"name":"btnUnpublish","class":"btn   btn-warning btn-sm","label":"Un-publish this collection","exposeAs":"btnUnpublish","context":"warning","type":"button","dsize":"btn-sm"},"children":[],"events":[{"type":"click","source":"var data = {\r\n    _id:$scope.id.getValue(),\r\n    onlineStatus:'unpublished'\r\n}\r\n\r\n$scope.collections.insertDocument(data);","name":"btnUnpublish"}],"macros":[],"styles":{"display":"none"},"dependencies":[],"impl":"bootstrap:button"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:column"}],"events":[],"macros":[],"styles":{"text-align":"center"},"dependencies":[],"impl":"bootstrap:row"},{"parameters":{"name":"Row_1","class":"row mt-3"},"children":[{"parameters":{"name":"Col","class":"col"},"children":[{"parameters":{"name":"btnArchive","class":"btn   btn-danger btn-sm","label":"Archive this collection","context":"danger","type":"button","dsize":"btn-sm"},"children":[],"events":[{"type":"click","source":"var data = {\r\n    _id:$scope.id.getValue(),\r\n    onlineStatus:'archived'\r\n}\r\n\r\n$scope.collections.insertDocument(data);","name":"btnArchive"}],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:button"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:column"}],"events":[],"macros":[],"styles":{"text-align":"center"},"dependencies":[],"impl":"bootstrap:row"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:div"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:div"},{"parameters":{"name":"card-images_1","class":"card mt-3 card-images","tag":"div","text":""},"children":[{"parameters":{"name":"body","class":"card-body","tag":"div","text":""},"children":[{"parameters":{"name":"title","class":"card-subtitle   mb-2 text-muted","tag":"label","text":"Choose an image for the collection"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:p"},{"parameters":{"name":"Row","class":"row"},"children":[{"parameters":{"name":"Col","class":"col 2 2   ","WidthExtraSmall":"nowidth","WidthSmall":"nowidth","WidthMedium":"nowidth","WidthLarge":"nowidth","WidthExtraLarge":"nowidth"},"children":[{"parameters":{"name":"image1","class":"form-group image slds-has-error","exposeAs":"image","type":"image","label":"","required":"true","hasError":"false"},"children":[{"parameters":{"name":"image1","class":"slds-image-input","exposeAs":"","binding":"image"},"children":[{"parameters":{"name":"image","src":"/resources/download/default/image1.","alt":"200 x 200"},"children":[],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:img"}],"events":[],"macros":[],"styles":{"position":"relative","text-align":"center"},"dependencies":[],"impl":"bootstrap:image-input"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:form-group"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:column"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:row"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:div"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"html:div"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:column"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"bootstrap:row"}],"events":[{"type":"submit","source":"$scope.products.insertDocument(evt.data);","name":"Form"}],"macros":[],"styles":{},"dependencies":[],"impl":"html:form"},{"parameters":{"name":"localhost"},"children":[{"parameters":{"name":"beelut"},"children":[{"parameters":{"name":"collections","exposeAs":"collections"},"children":[],"events":[{"type":"insertDocument","source":"$scope.$root.fireListener('saved',evt);","name":"collections"}],"macros":[],"styles":{},"dependencies":[],"impl":"mongo:collection"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"mongo:database"}],"events":[],"macros":[],"styles":{},"dependencies":[],"impl":"mongo:server"}],"events":[{"type":"applyparameter","source":"if(evt.name === 'data'){\r\n    var data = JSON.parse(evt.value);\r\n    $scope.textform.setData(data);\r\n    $scope.criteria.setData(data.criteria);\r\n    $scope.image.getInput().setValue(data.image);\r\n    $scope.andOr.setValue(data.andOr);\r\n    $scope.cardavailability.setStyle('display', null);\r\n    if(data.onlineStatus === 'published'){\r\n        $scope.btnUnpublish.setStyle('display', null);\r\n        $scope.btnPublish.setStyle('display', 'none');\r\n    }else{\r\n        $scope.btnUnpublish.setStyle('display', 'none');\r\n        $scope.btnPublish.setStyle('display', null);\r\n    }\r\n}else if(evt.name === 'new'){\r\n    $scope.textform.setData({title:\"\", description: \"\", _id:null});\r\n    $scope.criteria.setData([]);\r\n    $scope.image.getInput().setValue('');\r\n    $scope.andOr.setValue('and');\r\n    $scope.cardavailability.setStyle('display', 'none');\r\n    $scope.btnUnpublish.setStyle('display', 'none');\r\n        $scope.btnPublish.setStyle('display', null);\r\n}","name":"CreateCollection.prj"}],"macros":[],"styles":{},"data":{},"dependencies":[],"impl":"lgt:app"}